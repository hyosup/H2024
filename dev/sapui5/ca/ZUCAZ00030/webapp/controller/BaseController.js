sap.ui.define(["hkmc/ca/zucaz00010/controller/BaseController","sap/ui/model/json/JSONModel","hkmc/ca/zucaz00010/utils/Auth"],function(e,t,s){"use strict";return e.extend("hkmc.ca.zucaz00030.controller.BaseController",{_getAppID:function(){return"ZUCAZ00030"},_getAuth:function(){var e=this;var t=new s(this._getAppID());if(!this.getViewModel("viewConfig")){this.setViewModel(this.getModel("viewConfig"),"viewConfig")}e.getViewModel("viewConfig").setProperty("/isAuth",t.getAuth())},getResourceBundle:function(){return this.getOwnerComponent().getModel("i18n").getResourceBundle()},resetModelChanges:function(){var e=this.getView().getModel();if(e.hasPendingChanges()){e.resetChanges()}},initViewConfigModel:function(){this.getView().setModel(this.getOwnerComponent().getModel("viewConfig"),"viewConfig")},onBeforeUploadStarts:function(e){var t=this.getModel().getSecurityToken(),s=e.getSource(),i=e.getParameter("item");s.setBusy(true);s.insertHeaderField(new sap.ui.core.Item({key:"slug",text:encodeURIComponent(i.getFileName())}),1);s.insertHeaderField(new sap.ui.core.Item({key:"x-csrf-token",text:t}),1);s.insertHeaderField(new sap.ui.core.Item({key:"appid",text:this._getAppID()}),1);s.insertHeaderField(new sap.ui.core.Item({key:"cbokey",text:this._sFileKey}),1)},onUploadComplete:function(e){e.getSource().setBusy(false)},_submitSave:function(e){var t=this.getResourceBundle(),s=this.getView(),i=s.getModel(),o=s.byId("idForm");if(o.check().length>0){sap.m.MessageBox.error(t.getText("msgCheckMandatory"));return}i.submitChanges({success:function(s,i){this._sFileKey=o.getBindingContext().getProperty("Guid");this._oUploadSet.upload();this.setViewConfig("/isEdit",e);sap.m.MessageToast.show(t.getText("msgSaveSuccessfully"));this.goNavBack()}.bind(this),error:function(e){if(e.statusCode===500){sap.m.MessageToast.show(t.getText("msgUpdateError"))}else{sap.m.MessageToast.show(JSON.parse(e.responseText).error.message.value)}}})}})});